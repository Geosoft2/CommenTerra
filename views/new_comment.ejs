<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CommenTerra | New Comment</title>
    <link rel="stylesheet" href="css/commenterra.css" />
    <link rel="stylesheet" href="css/commenterra-icons.css" />
    <link rel="stylesheet" href="css/leaflet.css" />
    <link rel="stylesheet" href="css/vendor/jquery-ui.css" />
    <script src="js/vendor/jquery-1.11.2.js"></script>
    <script src="css/vendor/jquery-ui.js"></script>
    <script src="js/vendor/modernizr.js"></script>
    <script src="js/vendor/leaflet.js"></script>
    <script src="js/foundation.datepicker.js"></script>
    <script src="js/foundation-datepicker.js"></script>
    <link rel="stylesheet" href="css/labs.css" />
    <link rel="stylesheet" href="css/jquery.raty.css" />

    <!-- style for rate function and stars -->
    <style>
      .functions .demo {
        margin-bottom: 10px;
      }

      .functions .item {
        background-color: #FEFEFE;
        border-radius: 4px;
        display: inline-block;
        margin-bottom: 5px;
        padding: 5px 10px;
      }

      .functions .item a {
        border: 1px solid #CCC;
        margin-left: 10px;
        padding: 5px;
        text-decoration: none;
      }

      .functions .item input {
        display: inline-block;
        margin-left: 2px;
        padding: 5px 6px;
        width: 120px;
      }

      .functions .item label {
        display: inline-block;
        font-size: 1.1em;
        font-weight: bold;
      }

      .hint {
        text-align: center;
        width: 160px
      }

      div.hint {
        font-size: 1.4em;
        height: 46px;
        margin-top: 15px;
        padding: 7px
      }
    </style>

    <!-- autocomplete style -->
    <style>
      .ui-autocomplete {
        max-height: 100px;
        overflow-y: auto;
        /* prevent horizontal scrollbar */
        overflow-x: hidden;
      }
      /* IE 6 doesn't support max-height
      * we use height instead, but this forces the menu to always be this tall
      */
      * html .ui-autocomplete {
        height: 100px;
      }
    </style>

    <!-- script for autocomplete function -->
    <script>
      $(function() {
        var availableTags = [
          "ActionScript",
          "AppleScript",
          "Asp",
          "BASIC",
          "C",
          "C++",
          "Clojure",
          "COBOL",
          "ColdFusion",
          "Erlang",
          "Fortran",
          "Groovy",
          "Haskell",
          "Java",
          "JavaScript",
          "Lisp",
          "Perl",
          "PHP",
          "Python",
          "Ruby",
          "Scala",
          "Scheme"
        ];
        function split( val ) {
          return val.split( /,\s*/ );
        }
        function extractLast( term ) {
          return split( term ).pop();
        }
        $( "#tags" )
        // don't navigate away from the field on tab when selecting an item
        .bind( "keydown", function( event ) {
          if ( event.keyCode === $.ui.keyCode.TAB &&
          $( this ).autocomplete( "instance" ).menu.active ) {
            event.preventDefault();
          }
        })
        .autocomplete({
        minLength: 3,
        source: function( request, response ) {
          // delegate back to autocomplete, but extract the last term
          response( $.ui.autocomplete.filter(
            availableTags, extractLast( request.term ) 
          ) );
        },
        focus: function() {
          // prevent value inserted on focus
          return false;
        },
        select: function( event, ui ) {
          var terms = split( this.value );
          // remove the current input
          terms.pop();
          // add the selected item
          terms.push( ui.item.value );
          // add placeholder to get the comma-and-space at the end
          terms.push( "" );
          this.value = terms.join( ", " );
          return false;
          }
        });
      });
    </script>
  </head>

  <body>
    <!--fixed top-bar-->
    <div class="fixed">
    <nav class="top-bar" data-topbar role="navigation">
      <ul class="title-area"> 
        <li class="name"> 
          <h1><a href="/"> <font face="Helvetica" color="#424242" >&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspCommenTerra</font> </a></h1> 
        </li> 
        <!--remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone--> 
        <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li> 
      </ul>
      <section class="top-bar-section"> 
        <!--right nav section--> 
        <ul id="numero1" class="right">
          <li class="has-form">
            <form action="/api/v1" method="post" data-abide>
                <div class="row collapse">
				  <!--seperate this area in 9 areas-->
                  <div class="small-9 columns ">
                      <div class "search-field">
						<!--search for keyword field with an autocomplete function-->
                        <label> <input type="text" id="tags" placeholder="search for keyword" name="q"> </label>
                        <!-- small class="error">The Keyword must be alpha-numeric with at least 3 characters!</small-->
                      </div>
                  </div>
				  <!--override the count that adds up to 12 columns-->
                  <div class="small-3 columns end">
                    <button class="success radius expand" type="submit">Search</button>
                  </div>
                </div>
            </form>
          </li>
		  <!--Log-In modal-->
          <li><a href=<%= action %> data-reveal-id="LogInModal"><%= actionName %></a></li>
          <% if (!boolean1) { %>
          <div id="LogInModal" class="reveal-modal" data-reveal>
            <h2>Log In</h2>
            <p class="lead">Please log in with your e-mail and your password</p>
            <p><form data-abide>
              <div class="email-field">
                <label>E-Mail 
                  <small>required</small>
                  <input type="email" id="email" placeholder="info@commenterra.com" name="email" required pattern="email">  
                </label>
				<!--exception: invalid e-mail-->
                <small class="error">Please type in a valid e-mail-address!</small>
              </div>
              <div class="password-field">
                <label>Password 
                  <small>required</small>
                  <input type="password" id="password" placeholder="P4s$w0rd!" name="password" required> 
                </label>
				<!--exception: no password-->
                <small class="error">Please type in your password!</small>
              </div>
              <button class="radius" type="submit">Log In</button>
            </form></p>
            <a class="close-reveal-modal">&#215;</a>
          </div>
          <% } %>
		  <!--Site Navigation with links to "New Comment", "Advanced Search" and "Help / FAQ"-->
          <li class="has-dropdown"> 
            <a href="#">Site Navigation</a> 
            <ul class="dropdown"> 
              <li><a href="/comments/add">New Comment</a></li> 
              <li><a href="/api/v1/search">Advanced Search</a></li>
              <li><a href="/faq">Help / FAQ</a></li> 
			  <!--for the logged user is a further link to the personal "Profile" site-->
              <% if (boolean1) { %>
              <li><a href="/myprofile">Profile</a></li> 
              <% } %>
            </ul> 
          </li> 
        </ul> 
      </section>
    </nav>
    </div>

    <div class="fixed-under">
      <nav class="top-bar-border"></nav>
    </div>

    <!--dark grey area-->
    <form action=<%= addAction %> method="post" name="new_comment_form">
    <div class="panel custom">
		<!--segmenting this area in two areas-->
		<ul class="small-block-grid-2" data-equalizer>
			<li>
			  <font color="white" size="4">URL:</font>
			  <input type="text" name="url" id="firstStop" placeholder="URL..." value="<%= urlValue %>" />
			  <!--will be shown on on small and medium screens-->
			  <strong class="show-for-large-up">
				<button class="tiny radius expand" id="#" type="#" onclick="document.getElementById('urlResult').innerHTML = document.getElementById('firstStop').value">
				  <font color="#424242">Validate URL</font>
				</button>
			  </strong>
			  <!--will be shown on large screens-->
			  <strong class="hide-for-large-up">
				<button class="tiny radius expand" id="#" type="#" onclick="document.getElementById('urlResult1').innerHTML = document.getElementById('firtStop').value">
				  <font color="#424242">Validate URL</font>
				</button>
			  </strong>
			</li>
			<li>
				<!--shows the response of the URL-->
				<font color="white" size="4">Response:</font>
				<textarea id="numero5" disabled="disabled" rows="4"></textarea>
			</li>
		</ul>
    </div>

    <!--light grey area-->
    <div class="panel custom2">
	<!--will be shown on large screens-->
      <strong class="show-for-large-up">
	  <!--segmenting this area in two areas-->
        <ul class="small-block-grid-2" data-equalizer>
          <li>
            <div class="panel custom" data-equalizer-watch>
              <div class="panel custom2">
				<!--Comment area-->
                <dl class="accordion" data-accordion>
                  <dd class="accordion-navigation">
                    <a href="#panel1b">
                      <font color="#424242" size="4">Title:</font>
                      <input id="numero2" type="text" name="title" id="title" placeholder="Title..." />
                      <small class="error">You have to indicate a title!</small>
                    </a>
                    <div class="panel custom2">
                      <div id="panel1b" class="content">
                        <font color="#424242" size="4">URL:<p></p>
                          <p id="urlResult">
                            Your URL will be shown here after you validate it!
                          </p>
                        </font>
                        <p></p>
                        <!--segmenting this area in two areas-->
                        <ul class="small-block-grid-2">
                          <li>
                            <font color="#424242" size="4">Rating (optional):</font><br>
                            <!--five star rating-->
                            <div id="rating"></div>
                          </li>
                          <li>
                            <font color="#424242" size="4">Datepicker (optional):</font><br>
                            <!-- data binding for the starting date -->
                            <div data-abide data-date="12-02-2012" data-date-format="dd-mm-yyyy" >
                              <input type="text" id="datepicker1" placeholder="Beginning Date (MM/DD/YYYY)" name="date">
                              <small class="error">The date must be in the format: MM/DD/YYYY</small>
                            </div>
                            <!-- data binding for the ending date -->
                            <form data-abide>
                              <input type="text" id="datepicker2" placeholder="Ending Date (MM/DD/YYYY)" name="date" pattern="month_day_year">
                              <small class="error">The date must be in the format: MM/DD/YYYY</small>
                            </form>
                          </li>
                        </ul>
                        <p></p>
                        <font color="#424242" size="4">Comment:</font>
                        <dl class="accordion" data-accordion>
                          <dd class="accordion-navigation">
                            <textarea style="height:185px;resize:none;" name="message" id="message" placeholder="Comment..."></textarea>
                            <small class="error">You have to indicate a comment!</small>
                          </dd>
                        </dl>
                        <!--return the logged user or the anonyme unlogged user-->
                        <a href=""><font color="#2ba6cb">anonyme</font></a>
                        <p></p>
                        <!--segmenting this area in two areas-->
                        <ul class="small-block-grid-2">
                          <li>
                            <button id="numero3" class="success tiny radius expand" type="submit" data-reveal-id="circleModal">Set Areal</button>
                            <div id="circleModal" class="reveal-modal" data-reveal>
                              <p class="lead">Type on the map to create the center of the circle. Please inside a radius (in kilometers) for the areal.</p>
                              <input type="text" placeholder="radius in kilometers" />
                              <button class="success tiny radius expand" type="submit" data-reveal-id="circleModal">Create center</button>
                              <a class="close-reveal-modal">&#215;</a>
                            </div>
                          </li>
                          <li>
                            <button id="numero4" class="success tiny radius expand" type="submit" data-reveal-id="confirmModal">Submit Comment</button>
                            <div id="confirmModal" class="reveal-modal" data-reveal>
                              <p class="lead">Are you sure to submit the comment?</p>
                              <button class="success tiny radius expand" type="submit" data-reveal-id="confirmModal">Submit</button>
                              <a class="close-reveal-modal">&#215;</a>
                            </div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </dd>
                </dl>
              </div>
            </div>
          </li>
          <li>
            <div class="panel custom" data-equalizer-watch>
              <!--Map-->
              <div id="numero5">
              <div class="map" id="map1" style="width: 100%; height: 600px; border-radius: 3px"></div>
              </div>
            </div>
          </li>
        </ul>
      </strong>
	  <!--will be shown for small and medium screens-->
      <strong class="hide-for-large-up">
        <div class="panel custom">
          <!--two taps for Create a Comment and the Map-->
          <dl class="tabs" data-tab>
            <dd class="content active"><a href="#panel1">Create a Comment</a></dd>
            <dd class="content inactive"><a href="#panel2">View Map</a></dd>
          </dl>
          <div class="tabs-content">
            <div class="content active" id="panel1">
              <!--Comment-->
              <dl class="accordion" data-accordion>
                <dd class="accordion-navigation">
                  <a href="#panel1b">
                    <font color="#424242" size="4">Title:</font>
                    <input id="numero2" type="text" name="title" id="title" placeholder="Title..." />
                    <small class="error">You have to indicate a title!</small>
                  </a>
                  <div class="panel custom2">
                    <div id="panel1b" class="content">
                      <font color="#424242" size="4">URL:<p></p>
                        <p id="urlResult">Your URL will be shown here after you validate it!</p>
                      </font>
                      <p></p>
                      <!--segmenting this area in two areas-->
                      <font color="#424242" size="4">Rating (optional):</font><br>
                      <!--five star rating-->
                      <div id="rating"></div>
                      <font color="#424242" size="4">Datepicker (optional):</font><br>
                      <!-- data binding for the starting date -->
                      <div data-abide data-date="12-02-2012" data-date-format="dd-mm-yyyy" >
                        <input type="text" id="datepicker1" placeholder="Beginning Date (MM/DD/YYYY)" name="date">
                        <small class="error">The date must be in the format: MM/DD/YYYY</small>
                      </div>
                      <!-- data binding for the ending date -->
                      <form data-abide>
                        <input type="text" id="datepicker2" aceholder="Ending Date (MM/DD/YYYY)" name="date" pattern="month_day_year">
                        <small class="error">The date must be in the format: MM/DD/YYYY</small>
                      </form>
                      <p></p>
                      <font color="#424242" size="4">Comment:</font>
                      <dl class="accordion" data-accordion>
                        <dd class="accordion-navigation">
                          <textarea style="height:185px;resize:none;" name="message" id="message" placeholder="Comment..."></textarea>
                          <small class="error">You have to indicate a comment!</small>
                        </dd>
                      </dl>
                      <!--return the logged user or the anonyme unlogged user-->
                      <a href=""><font color="#2ba6cb">anonyme</font></a>
                      <p></p>
                      <!--segmenting this area in two areas-->
                      <button id="numero3" class="success tiny radius expand" type="submit" data-reveal-id="circleModal">Set Areal</button>
                      <div id="circleModal" class="reveal-modal" data-reveal>
                        <p class="lead">Type on the map to create the center of the circle. Please inside a radius (in kilometers) for the areal.</p>
                        <button class="success tiny radius expand" type="submit" data-reveal-id="circleModal">Create center</button>
                        <a class="close-reveal-modal">&#215;</a>
                      </div>
                      <button id="numero4" class="success tiny radius expand" type="submit" data-reveal-id="confirmModal">Submit Comment</button>
                      <div id="confirmModal" class="reveal-modal" data-reveal>
                        <p class="lead">Are you sure to submit the comment?</p>
                        <button class="success tiny radius expand" type="submit" data-reveal-id="confirmModal">Submit</button>
                        <a class="close-reveal-modal">&#215;</a>
                      </div>
                    </div>
                  </div>
                </dl>
              </dl>
            </div>

            <div class="content active" id="panel2">
              <!--Map-->
              <div class="map" id="map" style="width: 100%; height: 750px"></div>
            </div>
          </div>
          <script>              
                if (matchMedia('only screen and (max-width: 64em)').matches) {
                //Map for small screens
                var map = L.map('map');
		
		//load and display tile layers on the map
                L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
                  maxZoom: 20,
                  attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                    '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                    'Imagery © <a href="http://mapbox.com">Mapbox</a>',
                  id: 'examples.map-i875mjb7'
                }).addTo(map);

		//shows the location of the device
                function onLocationFound(e) {
                  var radius = e.accuracy / 2;
		  
                  L.marker(e.latlng).addTo(map)
                  .bindPopup("You are within " + radius + " meters from this point").openPopup();

                  L.circle(e.latlng, radius, {
                    color: '#2ba6cb',
                    fillColor: '#2ba6cb',
                    fillOpacity: 0.5
                  }).addTo(map);
                }

		//if the location can't retrieve it will be centerd on this point
                function onLocationError(e) {
                  map.setView([51.96935, 7.59588], 13);
                  alert(e.message);
                }

                map.on('locationfound', onLocationFound);
                map.on('locationerror', map.setView([51.96935, 7.59588], 13), onLocationError);

                map.locate({setView: true, maxZoom: 13});

                var popup = L.popup();

                function onMapClick(e) {
                  popup
                  .setLatLng(e.latlng)
                  .setContent("You clicked the map at " + e.latlng.toString())
                  .openOn(map);
                }

                map.on('click', onMapClick);
              }

              if (matchMedia('only screen and (min-width: 64.063em)').matches) {
                //Map for medium screens
                var map1 = L.map('map1');
                //var map1 = L.map('map1').setView([51.96935, 7.59588], 13);

		//load and display tile layers on the map
                L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
                  maxZoom: 20,
                  attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
                    '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                    'Imagery © <a href="http://mapbox.com">Mapbox</a>',
                  id: 'examples.map-i875mjb7'
                }).addTo(map1);

                function onLocationFound1(e) {
                  var radius1 = e.accuracy / 2;

                  L.marker(e.latlng).addTo(map1)
                  .bindPopup("You are within " + radius1 + " meters from this point").openPopup();

                  L.circle(e.latlng, radius1, {
                    color: '#2ba6cb',
                    fillColor: '#2ba6cb',
                    fillOpacity: 0.5
                  }).addTo(map1);
                }

		//shows the location of the device
                function onLocationError1(e) {
                  alert(e.message);
                }

                map1.on('locationfound', onLocationFound1);
                map1.on('locationerror', map1.setView([51.96935, 7.59588], 13), onLocationError1);

                map1.locate({setView: true, maxZoom: 16});

                function onMapClick1(e) {
                  popup
                  .setLatLng(e.latlng)
                  .setContent("You clicked the map at " + e.latlng.toString())
                  .openOn(map1);
                }

                map1.on('click', onMapClick1);

              }

           </script>
        </div>
      </strong>      
    </div>


    <!-- FOOTER
         on every page to get more informations -->
    <div class="panel custom4" style="width: 100%; height: 2px"></div>
    <div id="footer">
      || <a href="about.html"><font color="#424242">About CommenTerra / Contact</font></a> || 
      <a href="faq.html"><font color="#424242">FAQ / Help</font></a> ||
    </div>

	<!--joyride: Tour to get a first impression of this site-->
    <ol class="joyride-list" data-joyride>
      <li data-id="firstStop" data-text="Next" data-options="tip_location: top; prev_button: false">
        <p>At first you have to validate your URL. When this process was successfull you can create your Comment. On the right site you will see the Geo-Dataset from your URL.</p>
      </li>
	  <li data-id="numero2" data-text="Next" data-prev-text="Prev" data-options="tip_location:top; prev_button:false">
		<p>Here you are able to write a title of your comment</p>
	  </li>
	  <li data-id="numero3" data-text="Next" data-prev-text="Prev" data-options="tip_location:top; prev_button:false">
		<p>Here you can define a Bounding Box in the map of the right site</p>
	  </li>
	  <li data-id="numero4" data-text="Next" data-prev-text="Prev" data-options="tip_location:top; prev_button:false">
		<p>Save yout comment and attain automatically to the "CommenTerra | Home" site</p>
	  </li>
	  <li data-id="numero5" data-text="End" data-prev-text="Prev" data-options="tip_location: top">
	    <p>Here you can see the Response from your URL</p>
	  </li>
    </ol>

    <script src="js/vendor/jquery.js"></script>
    <script src="js/foundation.min.js"></script>
    <script src="js/foundation/foundation.joyride.js"></script>
    <script src="js/jquery.raty.js"></script>
    <script src="js/jquery.raty2.js"></script>
    <script src="js/labs.js"></script>

    <script>
      $(document).ready(function(){
        $("#rating").raty();
      });
    </script>
    <script>
      $(document).foundation();
      if (matchMedia('only screen and (min-width: 64.063em)').matches) {
        $(document).foundation('joyride', 'start');
      }
      
    </script>
    <script>
      $(document).foundation();
    </script>
    <script>
      jQuery(function() {
        jQuery( "#datepicker1" ).datepicker();
      });
    </script>
    <script>
      jQuery(function() {
        jQuery( "#datepicker2" ).datepicker();
      });
    </script>
    <script type="text/javascript">
      jQuery("#testButton").click(function(){
        document.new_comment_form.submit();
      });
    </script>  
  </body>
</html>
